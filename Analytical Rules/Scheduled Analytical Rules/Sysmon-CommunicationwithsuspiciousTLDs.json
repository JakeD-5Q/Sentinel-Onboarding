{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "workspace": {
            "type": "String"
        }
    },
    "resources": [
        {
            "id": "[concat(resourceId('Microsoft.OperationalInsights/workspaces/providers', parameters('workspace'), 'Microsoft.SecurityInsights'),'/alertRules/313c2678-9223-4cc2-89c0-395820ddf387')]",
            "name": "[concat(parameters('workspace'),'/Microsoft.SecurityInsights/313c2678-9223-4cc2-89c0-395820ddf387')]",
            "type": "Microsoft.OperationalInsights/workspaces/providers/alertRules",
            "kind": "Scheduled",
            "properties": {
                "incidentConfiguration": {
                    "createIncident": true,
                    "groupingConfiguration": {
                        "enabled": false,
                        "reopenClosedIncident": false,
                        "lookbackDuration": "PT5H",
                        "matchingMethod": "AllEntities",
                    "groupByEntities": [],
                "groupByAlertDetails": [],
            "groupByCustomDetails": []
        }
    },
    "queryFrequency": "PT5M",
    "queryPeriod": "PT5M",
    "triggerOperator": "GreaterThan",
    "triggerThreshold": 0,
    "eventGroupingSettings": {
        "aggregationKind": "SingleAlert"
    },
    "severity": "Medium",
    "query": "Event\r\n| where RenderedDescription has \".click\" \r\nor RenderedDescription has\".club\" \r\nor RenderedDescription has \".download\" \r\nor RenderedDescription has \".xxx\" \r\nor RenderedDescription has \".xyz\" \r\nor RenderedDescription has \".ru\" \r\nor RenderedDescription has \".pw\" \r\nor RenderedDescription has \".tk\" \r\nor RenderedDescription has \".ml\" \r\nor RenderedDescription has \".ga\" \r\nor RenderedDescription has \".gg\" \r\nor RenderedDescription has \".cf\" \r\nor RenderedDescription has \".su\"\r\n| where RenderedDescription !has \"windowsupdate.com\"\r\n| where RenderedDescription !has \"playground.xyz\"\r\n| where RenderedDescription !has \"yandex.ru\"\r\n| where RenderedDescription !has \"i.clean.gg\"\r\n| where RenderedDescription !has \"discord.gg\"\r\n| where RenderedDescription !has \"ml-api.io\"\r\n| where RenderedDescription !has \"s.ml-attr.com\"\r\n| where RenderedDescription !has \"charter.com\"\r\n| where RenderedDescription !has \"repositories.xyz\"\r\n| where RenderedDescription !has \"gitcdn.xyz\"\r\n| where RenderedDescription !has \"adriver.ru\"\r\n| where RenderedDescription !has \"adsniper.ru\"\r\n| where RenderedDescription !has \"Microsoft.VisualStudio.Setup\"\r\n| where RenderedDescription !has \"WindowsDefenderATPModule\"\r\n| where RenderedDescription !has \"Add-MalwareScan\"\r\n| extend AccountCustomEntity = UserName\r\n| extend HostCustomEntity = Computer",
    "suppressionDuration": "PT5H",
    "suppressionEnabled": false,
"tactics": [],
"displayName": "Sysmon - Communication with suspicious TLDs",
"enabled": true,
"description": "A machine has communicated with a suspicious top level domain.",
"alertRuleTemplateName": null
},
"apiVersion": "2021-09-01-preview"
}
]
}
